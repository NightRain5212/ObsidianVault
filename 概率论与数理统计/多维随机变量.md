
# 多维随机变量

若 $X,Y$ 是两个定义在同一个样本空间上的随机变量，则称 $(X,Y)$ 是二维随机变量。

同理可以定义 $n$ 维随机变量：$(X_1,X_2,X_3,...,X_n)$

映射关系：$\Omega \rightarrow \mathbb R^n$

# 联合分布函数

对任意的实数 $x$ 和 $y$ ，称函数
$$F(x,y)=P(X≤x,Y≤y)$$
为$(X,Y)$的联合分布函数.

## 性质

- 单调性：$F(x,y)$ 关于每个分量单调不降
- 有界性：$0\le F(x,y)\le 1,F(\infty,\infty)=1,F(-\infty ,y)=F(x,-\infty) = F(-\infty,-\infty) = 0$
- 右连续性：$F$分别关于$x,y$右连续
- 非负性：若$a_1 < b_1,a_2<b_2$
$$F(b_1,b_2)-F(a_1,b_2)-F(b_1,a_2)+F(a_1,a_2)=P(a_1\le X\le b_1,a_2\le Y\le b_2) \ge 0$$
- n维分布函数的非负性：
设$A = (a_1,b_1] \times (a_2,b_2]\times...\times(a_n,b_n]$，为n维矩体，$V=\{a_1,b_1\}\times ...\times \{a_n,b_n\}$，为A的所有顶点组成的集合，$v\in V$，$sgn(v)=(-1)^{v中a_i的个数}$，则
$$P((X_1,X_2,...X_N)\in A) = \sum_{v\in V} sgn(v)F(v) \ge 0$$


# 二维离散随机变量

若$(X,Y)$的可能取值为有限对或可列对，则称$(X,Y)$为二维离散随机变量

联合分布列
$$p_{ij}=P(X=x_i,Y=y_j),\quad i,j=1,2,\cdots $$

联合分布列也可以用表格表示

## 联合分布列的性质

- 非负性：$p_{ij}\ge 0$
- 正则性：$\sum_{i=1}^{\infty} \sum_{j=1}^{\infty} p_{ij}=1$

## 确定联合分布列的方法

- 确定联合向量$(X,Y)$的可能取值，
- 计算每个取值的概率
- 写出分布列

## 联合分布列求概率

设$(X,Y)$具有分布列$\{p_{ij},i,j\ge 1\}$，$D \subset \mathbb R^2$
$$P((X,Y)\in D) = \sum_{(i,j):(x_i,y_i)\in D} p_{ij}$$

# 二维连续分布

设二维随机变量$(X,Y)$ 的联合分布函数为$F(x,y)$，若存在函数$p(x,y)$ 使得$F(x,y)=\int_{-\infty}^x\int_{-\infty}^yp(u,\nu)dud\nu$，则称 $(X,Y)$ 为二维连续随机变量 $p(x,y)$ 称为**联合概率密度函数**

## 联合概率密度函数

- 非负性：$p(x,y)\ge 0$
- 正则性：$\iint_{R^2} p(x,y)dxdy=1$


## 联合密度函数求概率

- $D$ 为二维平面上任意区域
$$P((X,Y)\in D)=\iint_Dp(x,y)dxdy$$


- 已知
$$(X,Y)\sim p(x,y)=\begin{cases}f(x,y),&(x,y)\in D^*;\\\\0,&\text{否则}.\end{cases}$$
 求概率$P((X,Y)\in D)$

- 画出区域$I = D^* \cap D$，
$$P((X,Y)\in D)=\iint_Dp(x,y)dxdy=\iint_{D\cap D^*}f(x,y)dxdy$$
- 计算累次积分即可。

# 总结求概率

$$P((X,Y)\in D)=\begin{cases}\sum_{(i,j):(x_i,y_j)\in D}p_{ij},&\text{离散情形;}\\\iint_Dp(x,y)\mathrm{d}x\mathrm{d}y,&\text{连续情形}.\end{cases}$$

# 常见多维分布

## 多项分布

每次实验有$r$种结果：$a_1,a_2,...a_r$。记$P(a_i) = p_i,i=1,2,...,r$
记$X_i$为$n$次独立重复试验中$A_i$出现的次数，
则$(X_1,X_2,...,X_r)$联合分布列为
$$P(X_1=n_1,X_2=n_2,...X_r=n_r)=\begin{aligned}&\left\{\begin{array}{c}\frac{n!p_1^{n_1}\cdots p_r^{n_r}}{n_1!\cdots n_r!},&\sum_{i=1}^rn_i=n;\\0,&\text{否则}.\end{array}\right.\end{aligned}$$

## 多维超几何分布

口袋中有$N$只球，分成$r$类，第$i$种有$N_i$只，$N_1+N_2+...+N_r=N$.
从中任取$n$只，记$X_i$为这 $n$ 只中第$i$种球的个数.
则$(X_1,X_2,...,X_r)$联合分布列为
$$P(X_1=n_1,X_2=n_2,...X_r=n_r)=\begin{cases}\frac{C_{N_1}^{n_1}\cdots C_{N_r}^{n_r}}{C_N^n},&\sum_{i=1}^rn_i=n;\\0,&\text{否则}.&\end{cases}$$
## 二维均匀分布

若$(X,Y)\sim U(D)$， 则联合密度函数为
$$p(x,y)=\begin{cases}\frac1{S_D},&(x,y)\in D;\\0,&\text{否则}.&\end{cases}$$
其中$S_D$表示平面区域$D$的面积.

## 二维正态分布

$(X,Y)\sim N(\mu_1,\sigma_1^2;\mu_2,\sigma_2^2;\rho)$，其概率密度函数为
$$p(x,y)=\frac1{2\pi\sigma_1\sigma_2c}\exp\left[-\frac1{2c^2}(a^2+b^2-2\rho ab)\right]$$
$$\text{其中}a=\frac{x-\mu_1}{\sigma_1},b=\frac{y-\mu_2}{\sigma_2},c=\sqrt{1-\rho^2}.$$
# 边际分布

设$F(x,y)$为二维随机变量$(X,Y)$的联合分布函数，则$F(x,\infty)=F_X(x)$为随机变量$X$的分布函数，又称之为$X$的边际分布函数.同样，$Y$的边际分布函数为$F(\infty,y)=F_Y$.

## 边际分布列

若已知$(X,Y)$的联合分布列$p_{ij}$，则$X$的分布列为
$$p_i = \sum_{j=1}^{\infty} p_{ij}$$
同理则$Y$的分布列为
$$p_j = \sum_{i=1}^{\infty} p_{ij}$$
表格形式为
![48WEtxug6vULG2k.png](https://s2.loli.net/2025/11/20/48WEtxug6vULG2k.png)


## 边际概率密度函数

已知 $(X,Y)$ 的联合概率密度函数 $p(x,y)$ ，则$X$的联合概率密度函数为
$$p_X (x)=\int_{-\infty}^{\infty} p(x,y)dy  $$
则$X$的联合概率密度函数为
$$p_Y (y)=\int_{-\infty}^{\infty} p(x,y)dx  $$

## 性质

- 由联合分布可以求出边际分布
- 但由边际分布一般无法求出联合分布.
- 二维正态分布的边际分布是一维正态分布.
- 二维均匀分布的边际分布不一定是一维均匀分布.
- 边际分布为一维正态分布的二维随机向量不一定服从二维正态分布

# 独立性

若两个变量$X,Y$相互独立，则有
$$F(x,y) = F_X(x)F_Y(y)$$
同理，可以扩展至$n$维的情况
$$F(x_1,x_2,...,x_n) = F_{1}(x_1)F_2(x_2)...F_n(x_n)$$

- 若$(X,Y)$是离散型随机变量，$X,Y$相互独立
$$\forall (i,j),p_{ij}=p_ip_j$$
- 若$(X,Y)$是连续型随机变量，$X,Y$相互独立
$$\forall(x,y),p(x,y) =p_X(x)p_Y(y)$$
## 性质

- 若$X$与$Y$相互独立，则$f(X)$与$g(Y)$亦独立.
- 常数与任一随机变量相互独立
- $X_1,X_2,...,X_n$相互独立，则$(X_1,X_2,...,X_r)$与$(X_{r+1},...,X_n)$相互独立，它们的函数亦然.
- 若二维联合密度函数$p(x,y)$可分离为两个函数$g(x)$与$h(y)$的乘积，且$g(x)$的非0区域与$y$无关，$h(y)$的非0区域与$x$无关，则$X$与$Y$独立.
- 若$(X,Y)\sim U(D)$，当$D$为矩形区域时，$X$与$Y$独立；当$D$为圆盘时，$X$与$Y$不独立.
- 若$(X,Y)\sim N(\mu_1,\sigma_1^2;\mu_2,\sigma_2^2;\rho)$，则$X$与$Y$独立当且仅当$\rho=0$.

# 随机变量函数的分布

设已知$(X,Y)$的联合分布，求随机变量$Z = g(X,Y)$的分布函数。
设随机变量$(X,Y)$具有分布列$\{p_{ij},i,j=1,2,…\}$(离散情形)或概率密度函数$p(x,y)$连续情形)，则随机变量$Z=(X,Y)$的分布函数为
$$F_Z(z)=P((X,Y)\in D_z)\begin{cases}\sum_{(i,j):(x_i,y_j)\in D_z}p_{ij},&\text{离散情形};\\\iint_{D_z}p(x,y)\mathrm{d}x\mathrm{d}y,&\text{连续情形}.&\end{cases}$$
## 离散型随机变量函数

若二维离散型随机变量$(X,Y)$具有分布列$p_{ij},i,j=1,2,\cdots$,随机变量$Z=g(X,Y)$所有可能的取值为$z_k,k=1,2,\cdots$，则$Z$的分布列为
$$P(Z=z_k)=\sum_{(i,j):g(x_i,y_j)=z_k}p_{ij}.$$

### 卷积公式

若二维离散型随机变量$(X,Y)$具有分布列$p_{ij}=P(X=x_i,Y=y_j),i,j=1,2,\cdots$，
则$Z=X+Y$的分布列为
$$P(Z=z_k)=\sum_i P(X=x_i,Y=z_k-x_i)=\sum_k P(X=z_k-y_i,Y=y_i)$$
## 连续型随机变量函数

设随机变量$X$的概率密度函数为$P_X(x)$，$y=f(x)$是**严格单调函数**，且其**反函数**$x=h(y)$**有连续的导函数**，则随机变量$Y=f(X)$的**概率密度函数**为
$$p_Y(y)=\begin{cases}p_X(h(y))|h^{\prime}(y)|,&a<y<b;\\\\0,&\text{其他}.\end{cases}$$
$$\text{其中}\alpha=\min\{f(\infty),f(-\infty)\},b=\max\{f(\infty),f(-\infty)\}.$$

## 正态函数的线性不变性

- 若$X\sim N(\mu,\sigma^2)$，$a\not = 0$，$Y=aX+b$，则$Y\sim N(a\mu+b,a^2\sigma^2)$
- 特殊地，若$X\sim N(\mu,\sigma^2)$，$\frac{X-\mu}{\sigma}\sim N(0,1)$

## Gamma分布

- 若$X\sim Ga(\alpha,\lambda)$，$k>0$，则$kX\sim Ga(\alpha,\frac{\lambda}{k})$
- 若$X\sim N(0,\sigma^2)$，则$X\sim Ga(\frac{1}{2},\frac{1}{2\sigma^2})$

## 最值分布

设$X_1,X_2,...,X_n$相互独立，分布函数分别为$F_i(x)$，$p_i(x)$，若$Y=\max(X_1,...,X_n)$，$Z = \min(X_1,...,X_n)$，则有

$$F_Y(y) =\prod_{i=1}^n F_i(y)$$
$$F_Z(z) = 1-\prod_{i=1}^n(1-F_i(z))$$
因为
$$\max(X_1,...,X_n)\le y \Rightarrow X_1\le y,X_2\le y,...,X_n\le y$$
$$\min(X_1,...,X_n)\ge y \Rightarrow X_1\ge y,X_2\ge y,...,X_n\ge y$$

